<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create an ondisc_matrix from a single .mtx file or a list of .mtx files. — create_ondisc_matrix_from_mtx • ondisc</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create an ondisc_matrix from a single .mtx file or a list of .mtx files. — create_ondisc_matrix_from_mtx" />
<meta property="og:description" content="Initializes an ondisc_matrix from .mtx file(s), a features.tsv file, and barcode.tsv file(s).
The number of .mtx files should be the same of the number of the barcodes.tsv files. The list of .mtx files should share the same features.tsv file.
Returns an ondisc_matrix along with cell-specific and feature-specific covariate matrices." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ondisc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Function reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create an <code>ondisc_matrix</code> from a single .mtx file or a list of .mtx files.</h1>
    
    <div class="hidden name"><code>create_ondisc_matrix_from_mtx.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Initializes an <code>ondisc_matrix</code> from .mtx file(s), a features.tsv file, and barcode.tsv file(s).
The number of .mtx files should be the same of the number of the barcodes.tsv files. The list of .mtx files should share the same features.tsv file.
Returns an <code>ondisc_matrix</code> along with cell-specific and feature-specific covariate matrices.</p>
    </div>

    <pre class="usage"><span class='fu'>create_ondisc_matrix_from_mtx</span><span class='op'>(</span>
  <span class='va'>mtx_fp</span>,
  <span class='va'>barcodes_fp</span>,
  <span class='va'>features_fp</span>,
  <span class='va'>odm_fp</span>,
  metadata_fp <span class='op'>=</span> <span class='cn'>NULL</span>,
  n_lines_per_chunk <span class='op'>=</span> <span class='fl'>3e+08</span>,
  barcode_suffixes <span class='op'>=</span> <span class='cn'>NULL</span>,
  progress <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mtx_fp</th>
      <td><p>file path to .mtx file(s) storing the expression data. The .mtx file can represent either an integer matrix or a logical (i.e., binary) matrix. If the .mtx file contains only two columns (after the initial three-column row of metadata), then the .mtx file is assumed to represent a logical matrix.</p></td>
    </tr>
    <tr>
      <th>barcodes_fp</th>
      <td><p>file path to the .tsv file containing the cell barcodes.</p></td>
    </tr>
    <tr>
      <th>features_fp</th>
      <td><p>file path to the features.tsv file. The first column (required) contains the feature IDs (e.g., ENSG00000186092), and the second column (optional) contains the human-readable feature names (e.g., OR4F5). Subsequent columns are discarded.</p></td>
    </tr>
    <tr>
      <th>odm_fp</th>
      <td><p>location to write the ondisc matrix to disk.</p></td>
    </tr>
    <tr>
      <th>metadata_fp</th>
      <td><p>(optional; default NULL) location to write the metadata .RDS file. By default, a file called "metadata.rds" stored in the same directory as the backing .odm file.</p></td>
    </tr>
    <tr>
      <th>n_lines_per_chunk</th>
      <td><p>(optional) number of lines in .mtx file to process per chunk. Defaults to 3e+08.</p></td>
    </tr>
    <tr>
      <th>barcode_suffixes</th>
      <td><p>(optional; default NULL) a vector of suffix that appended to each barcodes in barcodes_fp. The length should be the same as the length of <code>barcodes_fp</code>. If NULL, append nothing for a single .mtx input; append file index for a list of .mtx inputs.</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>(optional; default TRUE) print progress messages?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>covariate_ondisc_matrix</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function can compute the following cell-specific and feature-specific covariates:</p><ul>
<li><p>cell-specific: (i) total number of features expressed in cell (n_nonzero_cell), (ii) total UMI count (n_umis_cell), and (iii) percentage of UMIs that map to mitochondrial genes (p_mito_cell).</p></li>
<li><p>feature-specific: (i) total number of cells in which feature is expressed (n_nonzero_feature), (ii) mean expression of feature across cells (mean_expression_feature), (iii) coefficient of variation of feature expression across cells (coef_of_variation_feature).</p></li>
</ul>

<p>The function decides which covariates to compute given the input; in general, the function computes the maximum set of covariates possible.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># # Please install the `ondiscdata` package before running the examples.</span>
<span class='co'># install.packages("devtools")</span>
<span class='co'># devtools::install_github("Katsevich-Lab/ondiscdata")</span>

<span class='co'># First example: initialize a `covariate_ondisc_matrix`</span>
<span class='co'># using simulated expression data; store output in tempdir()</span>
<span class='va'>tempfile</span> <span class='op'>&lt;-</span> <span class='fu'><a href='create_new_directory.html'>create_new_directory</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>odm_fp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>tempfile</span>, <span class='st'>"/expression_odm"</span><span class='op'>)</span>
<span class='va'>file_locs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/mtx"</span>, package <span class='op'>=</span> <span class='st'>"ondiscdata"</span>,
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"matrix.mtx"</span>, <span class='st'>"features.tsv"</span>, <span class='st'>"barcodes.tsv"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>file_locs</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"expressions"</span>, <span class='st'>"features"</span>, <span class='st'>"barcodes"</span><span class='op'>)</span>
<span class='va'>expression_data</span> <span class='op'>&lt;-</span> <span class='fu'>create_ondisc_matrix_from_mtx</span><span class='op'>(</span>mtx_fp <span class='op'>=</span> <span class='va'>file_locs</span><span class='op'>[[</span><span class='st'>"expressions"</span><span class='op'>]</span><span class='op'>]</span>,
barcodes_fp <span class='op'>=</span> <span class='va'>file_locs</span><span class='op'>[[</span><span class='st'>"barcodes"</span><span class='op'>]</span><span class='op'>]</span>,
features_fp <span class='op'>=</span> <span class='va'>file_locs</span><span class='op'>[[</span><span class='st'>"features"</span><span class='op'>]</span><span class='op'>]</span>,
n_lines_per_chunk <span class='op'>=</span> <span class='fl'>537000</span>,
odm_fp <span class='op'>=</span> <span class='va'>odm_fp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Writing CSC data.
#&gt; Writing CSR data.
#&gt; 
#&gt; Writing CSC data.
#&gt; Writing CSR data.
#&gt; 
#&gt; Writing CSC data.
#&gt; Writing CSR data.
#&gt; 
#&gt; Writing CSC data.
#&gt; Writing CSR data.</div><div class='input'>
<span class='co'># Second example: initialize from a list of .mtx files</span>
<span class='va'>tempfile</span> <span class='op'>&lt;-</span> <span class='fu'><a href='create_new_directory.html'>create_new_directory</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>odm_fp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>tempfile</span>, <span class='st'>"/expression_odm"</span><span class='op'>)</span>
<span class='va'>mtx_fp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/mtx_list"</span>, package <span class='op'>=</span> <span class='st'>"ondiscdata"</span>,
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mtx_dir1/matrix.mtx"</span>, <span class='st'>"mtx_dir2/matrix.mtx"</span>, <span class='st'>"mtx_dir3/matrix.mtx"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>barcodes_fp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/mtx_list"</span>, package <span class='op'>=</span> <span class='st'>"ondiscdata"</span>,
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mtx_dir1/barcodes.tsv"</span>, <span class='st'>"mtx_dir2/barcodes.tsv"</span>, <span class='st'>"mtx_dir3/barcodes.tsv"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>features_fp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"mtx_list/mtx_dir1/features.tsv"</span>, package <span class='op'>=</span> <span class='st'>"ondiscdata"</span><span class='op'>)</span>
<span class='va'>odm</span> <span class='op'>&lt;-</span> <span class='fu'>create_ondisc_matrix_from_mtx</span><span class='op'>(</span><span class='va'>mtx_fp</span>, <span class='va'>barcodes_fp</span>, <span class='va'>features_fp</span>, <span class='va'>odm_fp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; indexing matrix.mtx [===========--------------------------] 147.58GB/s, eta:  0sindexing matrix.mtx [=====================================] 336.32MB/s, eta:  0s                                                                                indexing matrix.mtx [====---------------------------------] 157.74GB/s, eta:  0sindexing matrix.mtx [=====================================] 269.11MB/s, eta:  0s                                                                                indexing matrix.mtx [======-------------------------------] 229.98GB/s, eta:  0sindexing matrix.mtx [=====================================] 283.15MB/s, eta:  0s                                                                                indexing matrix.mtx [========-----------------------------] 202.64GB/s, eta:  0sindexing matrix.mtx [=====================================] 317.58MB/s, eta:  0s                                                                                
#&gt; Writing CSC data.
#&gt; Writing CSR data.
#&gt; indexing matrix.mtx [====---------------------------------] 145.12GB/s, eta:  0sindexing matrix.mtx [=====================================] 276.65MB/s, eta:  0s                                                                                
#&gt; Writing CSC data.
#&gt; Writing CSR data.
#&gt; indexing matrix.mtx [======-------------------------------] 178.11GB/s, eta:  0sindexing matrix.mtx [=====================================] 279.05MB/s, eta:  0s                                                                                
#&gt; Writing CSC data.
#&gt; Writing CSR data.</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tim Barry, Songcheng Dai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


